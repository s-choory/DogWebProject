<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="PostsMapper">

<!-- list 화면 출력 및 페이징 관련 SQL문 -->
 <select id="selectList" resultType="Posts">
	select * from Posts where posttype = 'undeleted'
</select>

<!-- mypage list 화면 출력 및 페이징 관련 SQL문 -->
 <select id="selectList2" resultType="Posts" parameterType="String">
	select * from Posts where AUTHORID = #{userID}
</select>

<!-- 특정 페이징 getTotalCount -->
<select id="getTotalCount" parameterType="String" resultType="int">
 	SELECT COUNT(*) FROM Posts WHERE AUTHORID = #{UserID}
</select>

<select id="selectgetList" parameterType="String" resultType="Posts">
	SELECT * FROM Posts WHERE AUTHORID = #{userID}
</select>

<!-- 카테고리 totalCount -->
<select id="totalCount" parameterType="map" resultType="int">
      select count(*)
      from Posts
		<!-- 카테고리 select -->
			<if test="order == '전체' ">
    			where posttype = 'undeleted' order by CreationTime desc
   			</if>
    		<if test="order == '인기게시물' ">
    			where posttype = 'undeleted' order by Likes desc
    		</if>
    		<if test="order == 'QnA' ">
    		 	where posttype = 'undeleted' and Category = 'QnA' 
    		</if>
</select>

<!-- 카테고리 SelectAll -->
<select id="selectOrder" parameterType="map" resultType="com.dto.PostsDTO">
	  select *	from posts
    	<if test="order == '전체' ">
    		where posttype = 'undeleted' order by CreationTime desc
    	</if>
    	<if test="order == '인기게시물' ">
    		where posttype = 'undeleted' order by Likes desc
    	</if>
    	<if test="order == 'QnA'">
    		 where posttype = 'undeleted' and Category = 'QnA' 
    	</if>
</select>

<select id="selectOrder2" parameterType="map" resultType="com.dto.PostsDTO">
	    SELECT *
	    FROM posts
	    WHERE AUTHORID = #{userID}
	    <if test="order == '좋아요 누른 글' ">
    		
    	</if>
</select>

<!-- 검색조건 TotalCount -->
<select id="selectTotalCount" parameterType="map" resultType="int">
      select count(*)
      from Posts
        검색기능
      	<where>
			<if test="search != null">
			posttype = 'undeleted' and title like '%'||#{search}||'%' or content like '%'||#{search}||'%'
			</if>
		</where>
</select>

<!-- 검색조건 SelectAll -->
<select id="selectSearch" parameterType="map" resultType="com.dto.PostsDTO">
	  select * from posts
    <where>
    	<if test="search != null">
    		posttype = 'undeleted' and title like '%'||#{search}||'%' or content like '%'||#{search}||'%'
    	</if>
    </where>
</select>

 
 
</mapper>